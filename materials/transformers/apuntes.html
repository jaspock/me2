<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Apuntes de PyTorch | Juan Antonio Pérez-Ortiz</title> <meta name="author" content="Juan Antonio Pérez-Ortiz"> <meta name="description" content="Algunos apuntes sobre aspectos concretos de PyTorch"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%92%AC&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/me2/assets/css/main.css"> <link rel="canonical" href="https://jaspock.github.io/me2/materials/transformers/apuntes"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/me2/assets/js/theme.js"></script> <script src="/me2/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/me2/"><span class="font-weight-bold">Juan Antonio </span>Pérez-Ortiz</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/me2/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/me2/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/me2/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/me2/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/me2/materials/">materials</a> </li> <li class="nav-item "> <a class="nav-link" href="/me2/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/me2/teaching/">teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/me2/repositories/">repositories</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Apuntes de PyTorch</h1> <p class="post-description">Algunos apuntes sobre aspectos concretos de PyTorch</p> </header> <article> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/me2/assets/img/transformers/logo-mask-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/me2/assets/img/transformers/logo-mask-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/me2/assets/img/transformers/logo-mask-1400.webp"></source> <img src="/me2/assets/img/transformers/logo-mask.png" class="img-fluid rounded z-depth-1" width="256px" height="256px" title="ai-generated image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p class="small-text">Nota: este capítulo es parte de la serie “<a href="../transformers">Un recorrido peso a peso por el transformer</a>”, donde se presenta una guía para aprender cómo funcionan las redes neuronales que procesan textos y cómo se programan.</p> <p>Se incluyen aquí algunas notas sobre aspectos concretos de PyTorch que pueden ser útiles para entender nuestras implementaciones de modelos.</p> <h2 id="desestrujando-tensores">Desestrujando tensores</h2> <p>Una operación frecuente en PyTorch es la de <em>desestrujamiento</em><d-footnote>Es difícil encontrar una traducción adecuada para los términos <em>squeeze</em> y <em>unsqueeze</em> del inglés, pero puedes asociarlos a la alteración en la forma que se produce al abrir o cerrar instrumentos (denominados <em>squeezebox</em>) como un acordeón o una concertina.</d-footnote> de un tensor mediante la operación <code class="language-plaintext highlighter-rouge">unsqueeze</code>. Esta operación añade una dimensión de tamaño 1 en la posición indicada. Por ejemplo, si tenemos un tensor de forma <code class="language-plaintext highlighter-rouge">(2,3,4)</code> y aplicamos <code class="language-plaintext highlighter-rouge">unsqueeze(1)</code>, el resultado será un tensor de forma <code class="language-plaintext highlighter-rouge">(2,1,3,4)</code>. Si aplicamos <code class="language-plaintext highlighter-rouge">unsqueeze(0)</code>, el resultado será un tensor de forma <code class="language-plaintext highlighter-rouge">(1,2,3,4)</code>. Si aplicamos <code class="language-plaintext highlighter-rouge">unsqueeze(-1)</code>, el resultado será un tensor de forma <code class="language-plaintext highlighter-rouge">(2,3,4,1)</code>. Uno de los usos más típicos de <code class="language-plaintext highlighter-rouge">unsqueeze</code> es convertir un dato simple en un minibatch. Por ejemplo, imagina que tenemos un modelo de asignación de categorías léxicas (verbo, nombre, adjetivo, etc.) a palabras que recibe un minibatch de embeddings de diferentes palabras y nos devuelve para cada palabra un vector de probabilidades de asignación a cada categoría. Si queremos aplicar el modelo a una sola palabra, necesitamos convertir su embedding en un minibatch de un solo elemento y, para ello, podemos usar <code class="language-plaintext highlighter-rouge">unsqueeze(0)</code>. Si suponemos que el número de categorías es 10, tras ejecutar el modelo, el resultado será un tensor de forma <code class="language-plaintext highlighter-rouge">(1,10)</code>, que podemos convertir en un tensor de forma <code class="language-plaintext highlighter-rouge">(10)</code> con <code class="language-plaintext highlighter-rouge">squeeze(0)</code>. La operación <code class="language-plaintext highlighter-rouge">squeeze</code> es el complemento de <code class="language-plaintext highlighter-rouge">unsqueeze</code>: por defecto, elimina todas las dimensiones de tamaño 1, pero permite indicar la posición de la dimensión que queremos eliminar.</p> <p>Añadir una dimensión de tamaño 1 en la posición indicada, como hace <code class="language-plaintext highlighter-rouge">squeeze</code> no afecta al número de elementos del tensor, pero sí a su forma. El bloque de datos que contiene el tensor no se modifica en memoria. El siguiente ejemplo, muestra el resultado de operaciones de desestrujamiento sobre diferentes posiciones:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="n">torch</span> 
<span class="n">a</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="nf">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>  <span class="c1">#   [ [ 1,     2 ],     [ 3,     4 ] ]    2x2
</span><span class="n">a</span><span class="p">.</span><span class="nf">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                   <span class="c1"># [ [ [ 1,     2 ],     [ 3,     4 ] ] ]  1x2x2
</span><span class="n">a</span><span class="p">.</span><span class="nf">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                   <span class="c1"># [ [ [ 1,     2 ] ], [ [ 3,     4 ] ] ]  2x1x2
</span><span class="n">a</span><span class="p">.</span><span class="nf">squeeze</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                   <span class="c1"># [ [ [ 1 ], [ 2 ] ], [ [ 3 ], [ 4 ] ] ]  2x2x1
</span><span class="n">a</span><span class="p">.</span><span class="nf">squeeze</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c1"># exception: dimension out of range</span></code></pre></figure> <p>Como es habitual en PyTorch, las dimensiones pueden ser negativas, lo que permite indicar la posición de la dimensión contando desde el final. En el ejemplo anterior, <code class="language-plaintext highlighter-rouge">a.squeeze(-1)</code> es equivalente a <code class="language-plaintext highlighter-rouge">a.squeeze(3)</code>. En términos de la función <code class="language-plaintext highlighter-rouge">view</code>, <code class="language-plaintext highlighter-rouge">t.squeeze()</code> es equivalente a <code class="language-plaintext highlighter-rouge">view(*[s for s in t.shape if s != 1])</code>. Por otro lado, <code class="language-plaintext highlighter-rouge">t.unsqueeze(i)</code> equivale a <code class="language-plaintext highlighter-rouge">view(*t.shape[:i], 1, *t.shape[i:])</code>.</p> <p>Observar un tensor $n$-dimensional como una lista de tensores $(n-1)$-dimensionales facilita la comprensión de la representación de tensores en PyTorch. Te resultará probablemente más sencillo visualizar un tensor 5-dimensional como una lista de tensores de 4 dimensiones (y así sucesivamente) que como una matriz de cubos, por ejemplo.</p> <h2 id="vectores-fila-y-columna">Vectores fila y columna</h2> <p>La operación <code class="language-plaintext highlighter-rouge">squeeze</code> nos ayuda también a aclarar la diferencia entre la representación de vectores, vectores fila y vectores columna en PyTorch. Para empezar, considera estos dos tensores:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">a</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="nf">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">b</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="nf">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span></code></pre></figure> <p>El tensor <code class="language-plaintext highlighter-rouge">a</code> se corresponde con una matriz de 2x2 y <code class="language-plaintext highlighter-rouge">b</code> con un vector de 2 elementos. La operación <code class="language-plaintext highlighter-rouge">torch.mm(a,b)</code> produce un error porque los tamaños son incompatibles, ya que esta operación no hace <em>broadcasting</em> y solo funciona sobre dos matrices. Podemos transformar <code class="language-plaintext highlighter-rouge">b</code> en un vector columna <code class="language-plaintext highlighter-rouge">[[2],[3]]</code> de 2x1 con ayuda de <code class="language-plaintext highlighter-rouge">unsqueeze</code> para que <code class="language-plaintext highlighter-rouge">torch.mm(a,b.unsqueeze(1))</code> funcione correctamente. También podemos transformar <code class="language-plaintext highlighter-rouge">b</code> en un vector fila <code class="language-plaintext highlighter-rouge">[[2,3]]</code> de 1x2 con ayuda de <code class="language-plaintext highlighter-rouge">unsqueeze</code> para que <code class="language-plaintext highlighter-rouge">torch.mm(b.unsqueeze(0),a)</code> funcione correctamente. Observa que el resultado de ambos productos es evidentemente distinto (los tensores resultantes, de hecho, tienen formas diferentes). Podemos usar ahora <code class="language-plaintext highlighter-rouge">squeeze</code> sobre el resultado para obtener un vector de 2 elementos.</p> <p>La operación <code class="language-plaintext highlighter-rouge">torch.matmul</code> no solo soporta <em>broadcasting</em>, sino que está preparada para operar con tensores bidimensionales y unidimensionales. El resultado es en este caso un tensor unidimensional. Las siguientes dos aserciones, por tanto, no fallan:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">assert</span> <span class="n">torch</span><span class="p">.</span><span class="nf">equal</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nf">mm</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">a</span><span class="p">).</span><span class="nf">squeeze</span><span class="p">(),</span> <span class="n">torch</span><span class="p">.</span><span class="nf">matmul</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">torch</span><span class="p">.</span><span class="nf">equal</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nf">mm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)).</span><span class="nf">squeeze</span><span class="p">(),</span> <span class="n">torch</span><span class="p">.</span><span class="nf">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span></code></pre></figure> <h2 id="representación-en-memoria-de-los-tensores">Representación en memoria de los tensores</h2> <p>Consideremos, para simplificar, una matriz de 4x3 inicializada como sigue:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]])</span></code></pre></figure> <p>En memoria, los elementos de un tensor como el anterior se almacenan en posiciones consecutivas siguiendo un orden por filas, por lo que estos se encuentran dispuestos como 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12. El orden de almacenamiento de los elementos de un tensor se caracteriza mediante un concepto denominado <em>stride</em> (que podemos traducir por <em>salto</em> o <em>paso</em>) que se puede consultar con el método <code class="language-plaintext highlighter-rouge">stride</code>:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="nf">stride</span><span class="p">())</span>  <span class="c1"># (3, 1)</span></code></pre></figure> <p>La tupla <code class="language-plaintext highlighter-rouge">(3,1)</code> indica que para avanzar en la primera dimensión (las filas) de un elemento al siguiente es necesario saltar 3 posiciones en memoria y que para avanzar en la segunda dimensión (las columnas) de un elemento al siguiente es necesario saltar 1 posición en memoria.</p> <p>Hay operaciones de PyTorch (por ejemplo, la traspuesta o la función <code class="language-plaintext highlighter-rouge">view</code>) que modifican los pasos de los tensores sin mover los elementos en memoria, lo que hace que la operación sea muy eficiente al no tener que crear nuevos valores en memoria o reordenar los existentes:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="nf">t</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="nf">stride</span><span class="p">())</span>  <span class="c1"># (1, 3)</span></code></pre></figure> <p>Comprueba que los pasos <code class="language-plaintext highlighter-rouge">(1, 3)</code> son los correctos si no se han modificado los datos en memoria. Muchas operaciones de PyTorch están implementadas de manera que van iterando por los datos desde la última dimensión a la primera (primero por columnas y luego por filas, por ejemplo), esperando que esto suponga comenzar por las dimensiones de paso más pequeño (columnas, en nuestro caso) e ir moviéndose hacia dimensiones con pasos menores. De esta forma, cuando el algoritmo accede al siguiente dato, este suele ser un vecino del actual y estará probablemente disponible en caché. Si los elementos estuvieran dispuestos de otra manera en memoria, el algoritmo tendría que saltar más posiciones en memoria para acceder a los datos y, por tanto, sería más lento o directamente no funcionaría. Por ello, en ocasiones algunas operaciones (por ejemplo, <code class="language-plaintext highlighter-rouge">t.view(-1)</code>) lanzan una excepción y tendremos que reordenar explícitamente los datos en memoria del tensor afectado antes de poder usar dicha operación:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="nf">is_contiguous</span><span class="p">())</span>  <span class="c1"># True
</span><span class="nf">print</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="nf">is_contiguous</span><span class="p">())</span>  <span class="c1"># False
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="nf">data_ptr</span><span class="p">()</span><span class="o">==</span><span class="n">t</span><span class="p">.</span><span class="nf">data_ptr</span><span class="p">())</span>  <span class="c1"># True
</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">contiguous</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="nf">stride</span><span class="p">())</span>  <span class="c1"># (4, 1)
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="nf">data_ptr</span><span class="p">()</span><span class="o">==</span><span class="n">t</span><span class="p">.</span><span class="nf">data_ptr</span><span class="p">())</span>  <span class="c1"># False</span></code></pre></figure> <p>La operación <code class="language-plaintext highlighter-rouge">contiguous</code> devuelve el tensor de entrada (<code class="language-plaintext highlighter-rouge">self</code>) si este ya es contiguo y devuelven una copia con los datos reorganizados en caso contrario. Para tensores contiguos de cualquier forma, el paso es siempre mayor en una dimensión dada que en la siguiente:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">x</span><span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nf">stride</span><span class="p">())</span>  <span class="c1"># (24, 6, 2, 1)</span></code></pre></figure> <h2 id="modos-de-usar-matplotlib">Modos de usar Matplotlib</h2> <p>Hay dos formas diferentes de interactuar con la librería Matplotlib. Probablemente te encontrarás con ambos estilos en el código que encuentres en la web, por lo que es importante conocerlos. La primera forma (implícita) es la más sencilla y consiste en importar la librería y llamar a sus funciones de forma directa. La segunda forma es la más completa y consiste en crear un objeto <code class="language-plaintext highlighter-rouge">Figure</code> y llamar a sus métodos usando los objetos devueltos para interactuar con la librería. En ambos casos, se trabaja internamente con una figura y uno o más marcos asociados (en inglés <em>axes</em>, pero no confundir con los ejes o <em>axis</em> de un marco), pero en el primer caso se mantiene un estado global por lo que no es necesario usar explícitamente los distintos objetos y basta con llamar a la funciones directamente.</p> <p>Este es un ejemplo de código que usa la forma implícita:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">suptitle</span><span class="p">(</span><span class="s">'Sinusoidal function'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span></code></pre></figure> <p>Y este es un ejemplo de la forma explícita:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">suptitle</span><span class="p">(</span><span class="s">'Sinusoidal function'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span></code></pre></figure> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Juan Antonio Pérez-Ortiz. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/me2/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/me2/assets/js/zoom.js"></script> <script defer src="/me2/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>